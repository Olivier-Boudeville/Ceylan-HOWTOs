<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<title>Ceylan-HOWTOs: About Version Control Systems</title>
<link rel="stylesheet" href="pygments-default.css" type="text/css" />
<link rel="stylesheet" href="howtos.css" type="text/css" />
<link href="howtos-icon.png" rel="icon">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>
<div class="document" id="version-control-systems-in-practice-now-git">
<span id="top"></span>
<h1 class="title">Version Control Systems: in Practice, now, Git</h1>

<p><span class="raw-html"><a name="howtos_top"></a></span></p>
<p><span class="raw-html"><div class="banner"><p><em>Ceylan HOWTOs</em> <a href="http://howtos.esperide.org">browse latest</a> <a href="Ceylan-HOWTOs-english.pdf">get PDF</a> <a href="#howtos_top">go to top</a> <a href="#howtos_toc">go to toc</a> <a href="#howtos_bottom">go to bottom</a> <a href="Ceylan-HOWTOs-overview-english.html">go to HOWTOs</a> <a href="mailto:about(dash)ceylan-howtos(at)esperide(dot)com?subject=[Ceylan-HOWTOs]%20Remark%20about%20VCS">email us</a></p></div></span></p>
<p><span class="raw-html"><center><img src="howtos-title.png" id="responsive-image-ultrasmall"></img></span></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Organisation:</th><td class="field-body">Copyright (C) 2021-2023 Olivier Boudeville</td>
</tr>
<tr class="field"><th class="field-name">Contact:</th><td class="field-body">about (dash) howtos (at) esperide (dot) com</td>
</tr>
<tr class="field"><th class="field-name">Creation date:</th><td class="field-body">Saturday, November 20, 2021</td>
</tr>
<tr class="field"><th class="field-name">Lastly updated:</th><td class="field-body">Sunday, March 19, 2023</td>
</tr>
</tbody>
</table>
<p><span class="raw-html"><a name="howtos_toc"></a></span></p>
<div class="contents local topic" id="topic-1">
<span id="table-of-contents"></span><p class="topic-title"><strong>Table of Contents</strong></p>
<ul class="simple">
<li><a class="reference internal" href="#overview" id="toc-entry-1">Overview</a></li>
<li><a class="reference internal" href="#git-usage" id="toc-entry-2">Git Usage</a><ul>
<li><a class="reference internal" href="#recommended-general-conventions" id="toc-entry-3">Recommended General Conventions</a></li>
<li><a class="reference internal" href="#basic-operations" id="toc-entry-4">Basic Operations</a></li>
<li><a class="reference internal" href="#managing-branches" id="toc-entry-5">Managing Branches</a><ul>
<li><a class="reference internal" href="#merge-versus-rebase" id="toc-entry-6">Merge versus Rebase</a></li>
<li><a class="reference internal" href="#directly-transferring-changes" id="toc-entry-7">Directly Transferring Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#common-procedures" id="toc-entry-8">Common Procedures</a><ul>
<li><a class="reference internal" href="#overcoming-auto-signed-ssl-certificate-issues" id="toc-entry-9">Overcoming auto-signed SSL certificate issues</a></li>
<li><a class="reference internal" href="#setting-the-right-metadata-for-the-next-commits" id="toc-entry-10">Setting the right metadata for the next commits</a></li>
<li><a class="reference internal" href="#performing-operation-on-remotes-with-no-systematic-authentication" id="toc-entry-11">Performing operation on remotes with no systematic authentication</a></li>
<li><a class="reference internal" href="#updating-one-s-fork-from-its-upstream" id="toc-entry-12">Updating One's Fork from its Upstream</a></li>
<li><a class="reference internal" href="#creating-an-empty-branch" id="toc-entry-13">Creating an empty branch</a></li>
<li><a class="reference internal" href="#listing-differences-with-prior-versions-of-a-file" id="toc-entry-14">Listing differences with prior versions of a file</a></li>
<li><a class="reference internal" href="#preventing-the-commit-of-a-file-in-vcs-that-is-often-locally-modified" id="toc-entry-15">Preventing the commit of a file in VCS that is often locally modified</a></li>
<li><a class="reference internal" href="#listing-the-files-managed-in-vcs-from-the-current-directory" id="toc-entry-16">Listing the files managed in VCS from the current directory</a></li>
<li><a class="reference internal" href="#reducing-the-size-of-a-repository" id="toc-entry-17">Reducing the size of a repository</a></li>
<li><a class="reference internal" href="#fixing-lf-vs-crlf-end-of-line-problems" id="toc-entry-18">Fixing LF vs CRLF End of Line Problems</a></li>
<li><a class="reference internal" href="#fixing-a-commit-message" id="toc-entry-19">Fixing a commit message</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#tools" id="toc-entry-20">Tools</a><ul>
<li><a class="reference internal" href="#on-most-platforms" id="toc-entry-21">On Most Platforms</a></li>
<li><a class="reference internal" href="#on-windows" id="toc-entry-22">On Windows</a></li>
</ul>
</li>
<li><a class="reference internal" href="#inner-workings" id="toc-entry-23">Inner Workings</a></li>
<li><a class="reference internal" href="#translations" id="toc-entry-24">Translations</a></li>
<li><a class="reference internal" href="#documentation" id="toc-entry-25">Documentation</a></li>
</ul>
</div>
<p><span class="raw-html"></center></span></p>
<div class="section" id="overview">
<h1><a class="toc-backref" href="#toc-entry-1">Overview</a></h1>
<p>No real software development shall happen without the use of a VCS - standing for <em>Version Control System</em> - of some sorts, notably in order to track the versions of the source files involved and to ease the collaborative work on them.</p>
<p>Many solutions have been defined for this purpose (CVS, Clearcase, SVN, Mercurial, etc.), but now a single tool is the de facto standard: <a class="reference external" href="https://en.wikipedia.org/wiki/Git)">Git</a>, which is a distributed version control system available as free software; refer to <a class="reference external" href="https://git-scm.com/">its website</a> for more details.</p>
</div>
<div class="section" id="git-usage">
<h1><a class="toc-backref" href="#toc-entry-2">Git Usage</a></h1>
<p>Beyond the <a class="reference internal" href="#documentation">documentation</a> relative to its general use, projects have to adopt their own set of conventions - regarding the management of branches, commits, tags, etc - based on their preferences and context.</p>
<div class="section" id="recommended-general-conventions">
<h2><a class="toc-backref" href="#toc-entry-3">Recommended General Conventions</a></h2>
<p>The ones to which we try to stick are:</p>
<ul class="simple">
<li>the path (including names) of files and directories should not include spaces; as separator, prefer dashes (<tt class="docutils literal">-</tt>) to underscores (<tt class="docutils literal">_</tt>)</li>
<li>the character case shall be uniform (e.g. directory names starting always or never with a capital letter)</li>
<li>the language used shall be uniform (e.g. only English)</li>
<li>a commit message shall describe synthetically the modifications operated on the corresponding new filesystem snapshot; such a message, preferably in English, should always start with a capital letter and end with a dot; e.g. &quot;<em>Fixed the computation of angles.</em>&quot;</li>
<li>the file formats shall be, as much as possible, homogeneous, notably for text files with regard to the line terminators; either only UNIX conventions (only <tt class="docutils literal">LF</tt>; preferred), or only Windows ones (<tt class="docutils literal">CRLF</tt>); use <tt class="docutils literal">dos2unix</tt> whenever necessary, possibly automated through a Git hook</li>
<li>abbreviations are convenient (e.g. <tt class="docutils literal">br</tt> for branch, <tt class="docutils literal">co</tt> for <tt class="docutils literal">checkout</tt>, etc.); they can be defined in one's <tt class="docutils literal"><span class="pre">~/.gitconfig</span></tt></li>
</ul>
</div>
<div class="section" id="basic-operations">
<h2><a class="toc-backref" href="#toc-entry-4">Basic Operations</a></h2>
<ul class="simple">
<li><strong>managing branches</strong>:<ul>
<li><strong>creating</strong> branches is done thanks to the <tt class="docutils literal">checkout</tt> command, often abbreviated as <tt class="docutils literal">co</tt> here</li>
<li>to create a branch deriving from the current one (the current <tt class="docutils literal">HEAD</tt>) and switching to it at the same time (performing its co, while inheriting any local changes): <tt class="docutils literal">git co <span class="pre">-b</span> my_new_branch</tt></li>
<li>to <a class="reference external" href="https://git-scm.com/book/en/v2/Git-Branching-Remote-Branches">create a local branch corresponding to a remote one</a> (let's suppose it is named <tt class="docutils literal">some_branch</tt>), assuming that a remote server (e.g. <tt class="docutils literal">my_remote</tt>, possibly <tt class="docutils literal">origin</tt>) has already been declared (e.g. <tt class="docutils literal">git remote add my_remote URL</tt>):<ul>
<li>first step is to update the remote-tracking branches with <tt class="docutils literal">git fetch my_remote</tt>, then to create the target local branch tracking that remote (upstream) one with: <tt class="docutils literal">git co <span class="pre">-b</span> some_branch my_remote/some_branch</tt> (also switching to it here)</li>
<li>a shortcut is to use <tt class="docutils literal">git co <span class="pre">--track</span> my_remote/some_branch</tt> instead</li>
<li>even shorter, if the name of the target local branch name does not exist yet and matches exactly matches a name on only one remote, <tt class="docutils literal">git co some_branch</tt> will suffice</li>
</ul>
</li>
<li>to delete a local branch: <tt class="docutils literal">git branch <span class="pre">-d</span> my_branch</tt></li>
</ul>
</li>
<li><strong>managing tags</strong>:<ul>
<li>to list (local) tags: <tt class="docutils literal">git tag</tt></li>
<li>to have information about an already-existing tag: <tt class="docutils literal">git show my_tag</tt></li>
<li>to set a new annotated tag: <tt class="docutils literal">git tag <span class="pre">-a</span> <span class="pre">foobar-version-2.4.0</span> <span class="pre">-m</span> &quot;Release of the version 2.4.0 of Foobar.&quot;</tt>; prefer naming tags differently from branches (e.g. <tt class="docutils literal"><span class="pre">foobar-version-2.4.0</span></tt> rather than <tt class="docutils literal"><span class="pre">foobar-2.4.0</span></tt>) to spare ambiguities to Git</li>
<li>a set tag must be specifically pushed on a remote, for example: <tt class="docutils literal">git push origin my_tag</tt>; all tags can be pushed with <tt class="docutils literal">git push <span class="pre">--tags</span></tt> (the remote can be implied)</li>
<li>to delete a tag that was not pushed: <tt class="docutils literal">git tag <span class="pre">--delete</span> my_tag</tt></li>
</ul>
</li>
<li><strong>determining whether a file is in VCS</strong>, knowing that due to <tt class="docutils literal">.gitignore</tt> rules, <tt class="docutils literal"><span class="pre">update-index</span> <span class="pre">--skip-worktree</span></tt>, etc. it is not always obvious:</li>
</ul>
<pre class="code bash literal-block">
<span class="c1"># Target file is tracked iff is listed by:
</span>$<span class="w"> </span>git<span class="w"> </span>ls-files<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>my_file<span class="w">

</span><span class="c1"># Or, in order to trigger an error if this target file is not tracked:
</span>git<span class="w"> </span>ls-files<span class="w"> </span>--error-unmatch<span class="w"> </span>my_file
</pre>
<ul class="simple">
<li>getting the <strong>version of a file as it was at a given commit</strong>:</li>
</ul>
<pre class="code bash literal-block">
<span class="c1"># Replaces the current version of that file by the designated one:
</span>$<span class="w"> </span>git<span class="w"> </span>checkout<span class="w"> </span>COMMIT_ID<span class="w"> </span>path/to/the/target/file<span class="w">

</span><span class="c1"># Outputs on the console the designated version:
</span>$<span class="w"> </span>git<span class="w"> </span>show<span class="w"> </span>COMMIT_ID:path/to/the/target/file<span class="w">

</span><span class="c1"># Outputs on the console the diff between the designated
# version and the current one:
</span>$<span class="w"> </span>git<span class="w"> </span>show<span class="w"> </span>COMMIT_ID<span class="w"> </span>path/to/the/target/file
</pre>
<ul class="simple">
<li>listing the <strong>files modified by a given commit</strong>: <tt class="docutils literal">git show <span class="pre">--name-only</span> MY_COMMIT_ID</tt></li>
</ul>
</div>
<div class="section" id="managing-branches">
<h2><a class="toc-backref" href="#toc-entry-5">Managing Branches</a></h2>
<p>Creating branches allows to separate threads of work (while preserving their lineage) and progress concurrently. Yet often their content will have to converge ultimately; depending on the intent, two use cases can be considered, resulting in different Git uses.</p>
<div class="section" id="merge-versus-rebase">
<h3><a class="toc-backref" href="#toc-entry-6">Merge versus Rebase</a></h3>
<p>Here one may want:</p>
<ul class="simple">
<li>either to <strong>integrate back a development branch</strong> (e.g. <tt class="docutils literal"><span class="pre">my-feature</span></tt>) <strong>in a shared, parent one</strong> (e.g. <tt class="docutils literal">master</tt>): then one shall prefer using <tt class="docutils literal">merge</tt>, in order to keep separate histories and not affect the past one of the shared branch</li>
<li>or to <strong>resynchronise a development branch</strong> (e.g. <tt class="docutils literal"><span class="pre">my-feature</span></tt>) <strong>on the last version of a shared branch and continue these developments</strong>: then one shall prefer <tt class="docutils literal">rebase</tt>, so that the history of the development branch contains only its own changes (less noise, linear history)</li>
</ul>
<p>In practice, in order to transfer the changes of a branch A in a branch B:</p>
<pre class="code bash literal-block">
$<span class="w"> </span>git<span class="w"> </span>co<span class="w"> </span>B<span class="w">

</span><span class="c1"># Either first case (integrate development A in master B):
</span>$<span class="w"> </span>git<span class="w"> </span>merge<span class="w"> </span>A<span class="w"> </span><span class="c1"># or: git pull A
</span><span class="w">
</span><span class="c1"># Or second one (resynchronise development B on master A):
</span>$<span class="w"> </span>git<span class="w"> </span>rebase<span class="w"> </span>A<span class="w"> </span><span class="c1"># or: git pull -rebase A</span>
</pre>
<p>How such a last <tt class="docutils literal">rebase</tt> of branch A in branch B is done? The bifurcation point of B compared to A is moved from its initial position to the current head of A, on which all changes recorded in B are applied; the resulting history of B looks like if these changes had been directly performed from the version of A designated in this rebase, and thus B can be then directly fast-forwarded to its tip, which comprises both the changes synchronised from A and, then, the ones specifically introduced in B.</p>
<p>Then, to update the remote with these post-rebase commits, <tt class="docutils literal">git push <span class="pre">--force-with-lease</span></tt> shall be used <a class="footnote-reference" href="#footnote-1" id="footnote-reference-1">[1]</a>.</p>
<table class="docutils footnote" frame="void" id="footnote-1" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#footnote-reference-1">[1]</a></td><td>Rather than just performing just a push, having it fail, pulling, and ending up with duplicates of the changes. Should this happen, rewind these changes, for example with: <tt class="docutils literal">git reset <span class="pre">--hard</span> &lt;full_hash_of_commit_to_reset_to&gt;</tt>.</td></tr>
</tbody>
</table>
<p>More information: <a class="reference external" href="https://www.atlassian.com/en/git/tutorials/merging-vs-rebasing">[1]</a> or, in French: <a class="reference external" href="http://codeur-pro.fr/difference-entre-git-merge-et-git-rebase/">[2]</a>, <a class="reference external" href="https://meritis.fr/git-rebase-vs-git-merge-quelles-differences/">[3]</a>, <a class="reference external" href="http://blog.fclement.info/git-merge-et-git-rebase-les-eternels-incompris">[4]</a>.</p>
</div>
<div class="section" id="directly-transferring-changes">
<h3><a class="toc-backref" href="#toc-entry-7">Directly Transferring Changes</a></h3>
<p>Sometimes, one may want to directly transfer the changes of a derivate branch B in a parent branch A. When one knows for sure that the versions in B shall be preferred in all cases to their counterparts in A (note that a classical merge is already fully able to manage fast-forwards), one may use:</p>
<pre class="code bash literal-block">
$<span class="w"> </span>git<span class="w"> </span>checkout<span class="w"> </span>A<span class="w">
</span>$<span class="w"> </span>git<span class="w"> </span>merge<span class="w"> </span>-X<span class="w"> </span>theirs<span class="w"> </span>B
</pre>
<p>No conflict should arise (<a class="reference external" href="https://stackoverflow.com/questions/173919/is-there-a-theirs-version-of-git-merge-s-ours">source</a>).</p>
<p>The same is possible with <tt class="docutils literal">rebase</tt>; for example: <tt class="docutils literal">git rebase <span class="pre">-X</span> theirs B</tt>.</p>
<p>Note that <tt class="docutils literal"><span class="pre">-X</span></tt> a <em>strategy</em> option, whereas <tt class="docutils literal"><span class="pre">-s</span></tt> would be a <em>merge strategy</em> option.</p>
<p>Using here <tt class="docutils literal">ours</tt> rather than <tt class="docutils literal">theirs</tt> :</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">-X</span> ours</tt> uses &quot;our&quot; version of a change <em>only when there is a conflict</em></li>
<li>whereas <tt class="docutils literal"><span class="pre">-s</span> ours</tt> ignores the content of the other branch entirely (in all cases), and use &quot;our&quot; version instead</li>
</ul>
<p>Another way of forcing the content of a branch B to be the same as the one of a branch A is, while B is checked-out, to execute: <tt class="docutils literal">git reset <span class="pre">--hard</span> A</tt>. As mentioned previously, push shall be done then with <tt class="docutils literal">git push <span class="pre">--force-with-lease</span></tt>.</p>
</div>
</div>
<div class="section" id="common-procedures">
<h2><a class="toc-backref" href="#toc-entry-8">Common Procedures</a></h2>
<div class="section" id="overcoming-auto-signed-ssl-certificate-issues">
<h3><a class="toc-backref" href="#toc-entry-9">Overcoming auto-signed SSL certificate issues</a></h3>
<p>To avoid, typically in a company internal setting, errors like:</p>
<pre class="code bash literal-block">
Cloning<span class="w"> </span>into<span class="w"> </span><span class="s1">'XXX'</span>...<span class="w">
</span>fatal:<span class="w"> </span>unable<span class="w"> </span>to<span class="w"> </span>access<span class="w"> </span><span class="s1">'https://foo.bar.org/XX/XXX/'</span>:<span class="w"> </span>SSL<span class="w"> </span>certificate<span class="w"> </span>problem:<span class="w"> </span>self<span class="w"> </span>signed<span class="w"> </span>certificate<span class="w"> </span><span class="k">in</span><span class="w"> </span>certificate<span class="w"> </span>chain
</pre>
<p>the <tt class="docutils literal">http.sslVerify=false</tt> option may be used, even if it weakens the overall security.</p>
<p>This is typically useful initially:</p>
<pre class="code bash literal-block">
$<span class="w"> </span>git<span class="w"> </span>-c<span class="w"> </span>http.sslVerify<span class="o">=</span><span class="nb">false</span><span class="w"> </span>clone<span class="w"> </span>https://foo.bar.org/XX/XXX
</pre>
<p>In order that the next operations (e.g. future pushes) overcome too this problem for the current repository, use from within the current clone:</p>
<pre class="code bash literal-block">
$<span class="w"> </span>git<span class="w"> </span>config<span class="w"> </span>http.sslVerify<span class="w"> </span><span class="nb">false</span>
</pre>
</div>
<div class="section" id="setting-the-right-metadata-for-the-next-commits">
<h3><a class="toc-backref" href="#toc-entry-10">Setting the right metadata for the next commits</a></h3>
<p>Doing so prevent from having to amend commits a posteriori.</p>
<p>If these information apply for all projects:</p>
<pre class="code bash literal-block">
$<span class="w"> </span>git<span class="w"> </span>config<span class="w"> </span>--global<span class="w"> </span>user.name<span class="w"> </span><span class="s2">&quot;John Doe&quot;</span><span class="w">
</span>$<span class="w"> </span>git<span class="w"> </span>config<span class="w"> </span>--global<span class="w"> </span>user.email<span class="w"> </span>john.doe&#64;foobar.org
</pre>
<p>Otherwise shall be done at least on a per-project basis with:</p>
<pre class="code bash literal-block">
$<span class="w"> </span>git<span class="w"> </span>config<span class="w"> </span>user.name<span class="w"> </span><span class="s2">&quot;John Doe&quot;</span><span class="w">
</span>$<span class="w"> </span>git<span class="w"> </span>config<span class="w"> </span>user.email<span class="w"> </span>john.doe&#64;foobar.org
</pre>
<p>Also <tt class="docutils literal">git config <span class="pre">--global</span> <span class="pre">--edit</span></tt> may be of use (beware to trigger a <tt class="docutils literal">vi</tt> by accident...).</p>
</div>
<div class="section" id="performing-operation-on-remotes-with-no-systematic-authentication">
<h3><a class="toc-backref" href="#toc-entry-11">Performing operation on remotes with no systematic authentication</a></h3>
<p>Using a SSH key pair, hence with its public key declared on said remote, is a relevant approach, safer than from example using a <tt class="docutils literal"><span class="pre">~/.netrc</span></tt> file.</p>
</div>
<div class="section" id="updating-one-s-fork-from-its-upstream">
<h3><a class="toc-backref" href="#toc-entry-12">Updating One's Fork from its Upstream</a></h3>
<p>So you forked a repository (let's say it is in <tt class="docutils literal"><span class="pre">https://github.com/some_project/some_repo.git</span></tt>) and made progress - yet in the meantime the upstream repository may also have been updated, and you want to integrate these changes in yours.</p>
<p>First step is to ensure that this repository (designated here as <tt class="docutils literal">upstream</tt> for convenience) is locally known:</p>
<pre class="code bash literal-block">
$<span class="w"> </span>git<span class="w"> </span>remote<span class="w"> </span>add<span class="w"> </span>upstream<span class="w"> </span>https://github.com/some_project/some_repo.git
</pre>
<p>Then, from a fully-committed clone of your fork (let's suppose we are using the <tt class="docutils literal">main</tt> branch in all repositories):</p>
<pre class="code bash literal-block">
$<span class="w"> </span>git<span class="w"> </span>fetch<span class="w"> </span>upstream<span class="w">

</span><span class="c1"># More appropriate than a merge:
</span>$<span class="w"> </span>git<span class="w"> </span>rebase<span class="w"> </span>upstream/main<span class="w">

</span><span class="c1"># Repeatedly, as long as conflicts are found:
</span>$<span class="w"> </span>git<span class="w"> </span>rebase<span class="w"> </span>--continue<span class="w">

</span><span class="c1"># Forced, as otherwise the current branch will deemed to be behind our remote:
# (hopefully your branch at origin is not protected by a hook; otherwise:
# 'git checkout -b some_branch', etc.)
</span><span class="w">
</span>$<span class="w"> </span>git<span class="w"> </span>push<span class="w"> </span>-f<span class="w"> </span>origin<span class="w"> </span>main
</pre>
</div>
<div class="section" id="creating-an-empty-branch">
<h3><a class="toc-backref" href="#toc-entry-13">Creating an empty branch</a></h3>
<p>Rather than creating it from a pre-existing branch and removing all inherited content, prefer:</p>
<pre class="code bash literal-block">
$<span class="w"> </span>git<span class="w"> </span>checkout<span class="w"> </span>--orphan<span class="w"> </span>my_new_branch
</pre>
<p>(typically useful for GitHub Pages branches; may then be followed by some adds and <tt class="docutils literal">git commit <span class="pre">--allow-empty</span> <span class="pre">-m</span> &quot;Initial website.&quot;</tt>)</p>
</div>
<div class="section" id="listing-differences-with-prior-versions-of-a-file">
<h3><a class="toc-backref" href="#toc-entry-14">Listing differences with prior versions of a file</a></h3>
<p>In order to list the differences of a given file with the previous commits (precisely: of a set of pathspecs), one may use our <tt class="docutils literal"><span class="pre">dif-prev.sh</span></tt> script, which by default reports the differences with the last committed version. With the <tt class="docutils literal"><span class="pre">--all</span></tt> option, it lists all differences, until the first addition of this file.</p>
</div>
<div class="section" id="preventing-the-commit-of-a-file-in-vcs-that-is-often-locally-modified">
<h3><a class="toc-backref" href="#toc-entry-15">Preventing the commit of a file in VCS that is often locally modified</a></h3>
<p>One should use <a class="reference external" href="https://stackoverflow.com/questions/1753070/how-do-i-configure-git-to-ignore-some-files-locally">this method</a>:</p>
<pre class="code bash literal-block">
$<span class="w"> </span>git<span class="w"> </span>update-index<span class="w"> </span>--skip-worktree<span class="w"> </span>&lt;file-list&gt;
</pre>
<p>The opposite operation is:</p>
<pre class="code bash literal-block">
$<span class="w"> </span>git<span class="w"> </span>update-index<span class="w"> </span>--no-skip-worktree<span class="w"> </span>&lt;file-list&gt;
</pre>
</div>
<div class="section" id="listing-the-files-managed-in-vcs-from-the-current-directory">
<h3><a class="toc-backref" href="#toc-entry-16">Listing the files managed in VCS from the current directory</a></h3>
<p>Use <tt class="docutils literal">git <span class="pre">ls-files</span></tt> to determine the files that are already managed in VCS, recursively from the current directory.</p>
<p>To list the untracked files (i.e. the files <em>not</em> in VCS), use <tt class="docutils literal">git <span class="pre">ls-files</span> <span class="pre">--others</span></tt>.</p>
</div>
<div class="section" id="reducing-the-size-of-a-repository">
<h3><a class="toc-backref" href="#toc-entry-17">Reducing the size of a repository</a></h3>
<p>One may use our <a class="reference external" href="https://github.com/Olivier-Boudeville/Ceylan-Hull/blob/master/list-largest-vcs-blobs.sh">list-largest-vcs-blobs.sh</a> script to detect any larger files that should not be in VCS (e.g. should a colleague have committed by mistake a third-party archive, or unexpected data such as CSV files).</p>
<p>Then install <a class="reference external" href="https://rtyley.github.io/bfg-repo-cleaner/">BFG Repo-Cleaner</a>:</p>
<pre class="code bash literal-block">
$<span class="w"> </span>mkdir<span class="w"> </span>-p<span class="w"> </span>~/Software/bfg-repo-cleaner/<span class="w">
</span>$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span><span class="nv">$_</span><span class="w">
</span>$<span class="w"> </span>mv<span class="w"> </span>~/bfg-1.14.0.jar<span class="w"> </span>.<span class="w">
</span>$<span class="w"> </span>ln<span class="w"> </span>-s<span class="w"> </span>bfg-1.14.0.jar<span class="w"> </span>bfg.jar<span class="w">
</span><span class="c1"># For example in ~/.bashrc:
</span>$<span class="w"> </span><span class="nb">alias</span><span class="w"> </span><span class="nv">bfg</span><span class="o">=</span><span class="s2">&quot;java -jar ~/Software/bfg-repo-cleaner/bfg.jar&quot;</span>
</pre>
<p>All developers should be asked to commit their sources (git add + push), to archive their clone (e.g. in a timestamped <tt class="docutils literal">.xz</tt> file like <tt class="docutils literal"><span class="pre">20220412-archive-clone-foobar.tar.xz</span></tt>), and to wait until notified that they can create a new clone.</p>
<p>The repository may be then cleaned up (e.g. from large, unnecessary CSV files) in isolation, with:</p>
<pre class="code bash literal-block">
$<span class="w"> </span>git<span class="w"> </span>clone<span class="w"> </span>--mirror<span class="w"> </span>XXX/foobar.git<span class="w">
</span>$<span class="w"> </span>bfg<span class="w"> </span>--delete-files<span class="w"> </span><span class="s1">'*.csv'</span><span class="w"> </span>foobar.git<span class="w">
</span>$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>foobar<span class="w">
</span>$<span class="w"> </span>git<span class="w"> </span>reflog<span class="w"> </span>expire<span class="w"> </span>--expire<span class="o">=</span>now<span class="w"> </span>--all<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>git<span class="w"> </span>gc<span class="w"> </span>--prune<span class="o">=</span>now<span class="w"> </span>--aggressive<span class="w">
</span>$<span class="w"> </span>git<span class="w"> </span>push
</pre>
<p>Then all developers shall be requested to perform a new clone and to check the fetched content (e.g. with regard to the content of the last branch in which they committed).</p>
</div>
<div class="section" id="fixing-lf-vs-crlf-end-of-line-problems">
<h3><a class="toc-backref" href="#toc-entry-18">Fixing LF vs CRLF End of Line Problems</a></h3>
<p>Use <a class="reference external" href="https://git-scm.com/book/en/v2/Customizing-Git-Git-Attributes">Git Attributes</a> to specify proper files and paths attributes.</p>
<p>One may define a <tt class="docutils literal">.gitattributes</tt> file for example with <tt class="docutils literal">*.js eol=lf</tt>, <tt class="docutils literal">* text=auto</tt>, or:</p>
<pre class="code bash literal-block">
<span class="c1"># No CRLF conversion for DOS/Windows batch files.
# They should be stored with the CRLF line terminators.
#
</span>*.bat<span class="w"> </span>-crlf
</pre>
</div>
<div class="section" id="fixing-a-commit-message">
<h3><a class="toc-backref" href="#toc-entry-19">Fixing a commit message</a></h3>
<p>If no push was done, it is as simple as replacing the former message by a new one, like in:</p>
<pre class="code bash literal-block">
$<span class="w"> </span>git<span class="w"> </span>commit<span class="w"> </span>--amend<span class="w"> </span>-m<span class="w"> </span><span class="s2">&quot;This is a fixed commit message.&quot;</span>
</pre>
</div>
</div>
</div>
<div class="section" id="tools">
<h1><a class="toc-backref" href="#toc-entry-20">Tools</a></h1>
<div class="section" id="on-most-platforms">
<h2><a class="toc-backref" href="#toc-entry-21">On Most Platforms</a></h2>
<p>At least on UNIX, the command-line Git client (<tt class="docutils literal">git</tt>) is certainly the best tool. In difficult situations, graphical tools such as <tt class="docutils literal">gitk</tt> may be of help.</p>
<p>See also our Ceylan-Hull section about <a class="reference external" href="https://hull.esperide.org/#for-version-control-system-vcs">VCS-related scripts</a>.</p>
</div>
<div class="section" id="on-windows">
<h2><a class="toc-backref" href="#toc-entry-22">On Windows</a></h2>
<p>Tools like <a class="reference external" href="https://tortoisegit.org/">TortoiseGit</a> may foster a view on the usage of Git that is a bit particular, conflating concepts or introducing extra ones (e.g. a <tt class="docutils literal">sync</tt> command). Apparently also at least some pulls did not reintroduce files just removed from the working directory.</p>
<p>More generally, cloning on a Windows host an UNIX-originating repository comprising symbolic links may induce oddities (e.g. a symlink named <tt class="docutils literal">S</tt> pointing to <tt class="docutils literal">Foobar</tt> resulting, on a Windows clone, in a file named <tt class="docutils literal">S</tt> whose content is, literally, the text <tt class="docutils literal">&quot;Foobar&quot;</tt>, instead of the expected content of the <tt class="docutils literal">Foobar</tt> file).</p>
<p>Another option is to use Visual Studio Code (<tt class="docutils literal">vscode</tt>), which supports natively Git (provided that the command-line version is already installed). One may select <tt class="docutils literal">View <span class="pre">-&gt;</span> SCM</tt> (or <tt class="docutils literal"><span class="pre">Ctrl-Shift-G</span></tt>) for that. Clicking on the &quot;VCS&quot; icon (three rings links by two curves; the third from the top) displays a contextual view offering various associated operations (here based on Git).</p>
<p>We finally preferred using MSYS2 + Git rather than <a class="reference external" href="https://gitforwindows.org/">Git Bash</a>, named &quot;Git for Windows&quot;; <a class="reference external" href="http://source.technology/speed-up-git-bash-on-windows">hints</a> to speed up these tools may apply.</p>
</div>
</div>
<div class="section" id="inner-workings">
<h1><a class="toc-backref" href="#toc-entry-23">Inner Workings</a></h1>
<p>Git stores internally every version of every file separately (not as a diff with a parent version) as a blob (an opaque binary content) identified by its (SHA1) hash.</p>
<p>A commit is the identifier of a tree representing the filesystem of interest at a given moment (snapshot). This tree references the files through their SHA1, similarly to a <a class="reference external" href="https://en.wikipedia.org/wiki/Merkle_tree">Merkle tree</a>.</p>
<p>A branch is thus nothing but a pointer on a given commit, and <tt class="docutils literal">HEAD</tt> designates the current branch. Git stores natively only blobs, trees and commits.</p>
<p>The reported differences in the content of a file or a tree are thus only recreated (established dynamically) by Git commands, they are not natively tracked.</p>
</div>
<div class="section" id="translations">
<h1><a class="toc-backref" href="#toc-entry-24">Translations</a></h1>
<p>From English to French:</p>
<ul class="simple">
<li><tt class="docutils literal">repository</tt> -&gt; <tt class="docutils literal">dépôt</tt></li>
<li><tt class="docutils literal">to checkout</tt> -&gt; <tt class="docutils literal">extraire</tt></li>
<li><tt class="docutils literal">to commit</tt> -&gt; <tt class="docutils literal">valider</tt></li>
<li><tt class="docutils literal">a commit</tt> -&gt; <tt class="docutils literal">validation</tt></li>
<li><tt class="docutils literal">in VCS</tt> -&gt; <tt class="docutils literal">en GCL</tt> (Gestion de Configuration Logicielle)</li>
<li><tt class="docutils literal">snapshot</tt> -&gt; <tt class="docutils literal">instantané</tt> (de l'état du sous-système de fichiers géré en GCL)</li>
<li><tt class="docutils literal">merge</tt> -&gt; <tt class="docutils literal">fusion</tt></li>
<li><tt class="docutils literal">head</tt> -&gt; <tt class="docutils literal">tête</tt></li>
<li><tt class="docutils literal"><span class="pre">fast-forward</span></tt> -&gt; <tt class="docutils literal">avancement direct</tt></li>
<li><tt class="docutils literal"><span class="pre">fast-forwarded</span></tt> -&gt; <tt class="docutils literal">directement avancée</tt></li>
</ul>
</div>
<div class="section" id="documentation">
<h1><a class="toc-backref" href="#toc-entry-25">Documentation</a></h1>
<p>Many pointers exist, doing a great job in unveiling how Git is to be used.</p>
<p>In English, <a class="reference external" href="https://git-scm.com/book/en/v2">Pro GIT</a> is surely a reference.</p>
<p>In French:</p>
<ul class="simple">
<li><a class="reference external" href="https://perso.liris.cnrs.fr/pierre-antoine.champin/enseignement/intro-git/)del'IUTLyon-1">introduction en français</a></li>
<li><a class="reference external" href="https://openclassrooms.com/fr/courses/1233741-gerez-vos-codes-source-avec-git">cours sur OpenClassrooms</a></li>
<li>référence incontournable et conseillée : <a class="reference external" href="https://git-scm.com/book/fr/v2">Pro GIT</a>, notamment pour l'explication de <a class="reference external" href="https://git-scm.com/book/fr/v2/D%C3%A9marrage-rapide-Rudiments-de-Git">ses rudiments</a> puis de son <a class="reference external" href="https://git-scm.com/book/fr/v2/Les-tripes-de-Git-Plomberie-et-porcelaine">fonctionnement interne</a>, à commencer par <a class="reference external" href="https://git-scm.com/book/fr/v2/Les-tripes-de-Git-Les-objets-de-Git">ses objets</a></li>
</ul>
<p><span class="raw-html"><a name="howtos_bottom"></a></span></p>
</div>
</div>
</body>
</html>
