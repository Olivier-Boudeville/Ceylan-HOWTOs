<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<title>Ceylan-HOWTOs: About GNU/Linux</title>
<link rel="stylesheet" href="pygments-default.css" type="text/css" />
<link rel="stylesheet" href="howtos.css" type="text/css" />
<link href="howtos-icon.png" rel="icon">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>
<div class="document" id="using-the-gnu-linux-operating-system">
<span id="top"></span>
<h1 class="title">Using the GNU/Linux Operating System</h1>

<p><span class="raw-html"><a name="howtos_top"></a></span></p>
<p><span class="raw-html"><div class="banner"><p><em>Ceylan HOWTOs</em> <a href="http://howtos.esperide.org">browse latest</a> <a href="Ceylan-HOWTOs-english.pdf">get PDF</a> <a href="#howtos_top">go to top</a> <a href="#howtos_toc">go to toc</a> <a href="#howtos_bottom">go to bottom</a> <a href="Ceylan-HOWTOs-overview-english.html">go to HOWTOs</a> <a href="mailto:about(dash)ceylan-howtos(at)esperide(dot)com?subject=[Ceylan-HOWTOs]%20Remark%20about%20GNU/Linux">email us</a></p></div></span></p>
<p><span class="raw-html"><center><img src="howtos-title.png" id="responsive-image-ultrasmall"></img></span></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Organisation:</th><td class="field-body">Copyright (C) 2021-2023 Olivier Boudeville</td>
</tr>
<tr class="field"><th class="field-name">Contact:</th><td class="field-body">about (dash) howtos (at) esperide (dot) com</td>
</tr>
<tr class="field"><th class="field-name">Creation date:</th><td class="field-body">Sunday, December 19, 2021</td>
</tr>
<tr class="field"><th class="field-name">Lastly updated:</th><td class="field-body">Saturday, January 28, 2023</td>
</tr>
</tbody>
</table>
<p><span class="raw-html"><a name="howtos_toc"></a></span></p>
<div class="contents local topic" id="topic-1">
<span id="table-of-contents"></span><p class="topic-title"><strong>Table of Contents</strong></p>
<ul class="simple">
<li><a class="reference internal" href="#overview" id="toc-entry-1">Overview</a></li>
<li><a class="reference internal" href="#software-update" id="toc-entry-2">Software Update</a></li>
<li><a class="reference internal" href="#package-management" id="toc-entry-3">Package Management</a><ul>
<li><a class="reference internal" href="#configuration" id="toc-entry-4">Configuration</a></li>
<li><a class="reference internal" href="#package-related-commands" id="toc-entry-5">Package-related Commands</a></li>
<li><a class="reference internal" href="#interesting-packages" id="toc-entry-6">Interesting Packages</a></li>
</ul>
</li>
<li><a class="reference internal" href="#systemd-related-hints" id="toc-entry-7">Systemd-related Hints</a><ul>
<li><a class="reference internal" href="#systemd-commands" id="toc-entry-8">Systemd Commands</a></li>
<li><a class="reference internal" href="#systemd-journal" id="toc-entry-9">Systemd Journal</a></li>
</ul>
</li>
<li><a class="reference internal" href="#process-related-post-mortem-investigations" id="toc-entry-10">Process-related Post-Mortem Investigations</a></li>
<li><a class="reference internal" href="#filesystem-related-issues" id="toc-entry-11">Filesystem-related Issues</a><ul>
<li><a class="reference internal" href="#target-is-busy" id="toc-entry-12">Target is busy</a></li>
<li><a class="reference internal" href="#failed-i-o-operations" id="toc-entry-13">Failed I/O Operations</a></li>
<li><a class="reference internal" href="#checking-a-disk" id="toc-entry-14">Checking a Disk</a></li>
</ul>
</li>
<li><a class="reference internal" href="#quick-topics" id="toc-entry-15">Quick Topics</a><ul>
<li><a class="reference internal" href="#installing-wine" id="toc-entry-16">Installing Wine</a></li>
<li><a class="reference internal" href="#invalid-pgp-signatures-in-packages" id="toc-entry-17">Invalid PGP Signatures in Packages</a></li>
<li><a class="reference internal" href="#adding-a-locale" id="toc-entry-18">Adding a Locale</a></li>
<li><a class="reference internal" href="#applying-a-xfce4-configuration-to-a-different-user" id="toc-entry-19">Applying a XFCE4 configuration to a different user</a></li>
<li><a class="reference internal" href="#emacs" id="toc-entry-20">Emacs</a></li>
<li><a class="reference internal" href="#e-mail-clients" id="toc-entry-21">E-mail Clients</a></li>
<li><a class="reference internal" href="#other-settings" id="toc-entry-22">Other Settings</a></li>
<li><a class="reference internal" href="#shortcuts" id="toc-entry-23">Shortcuts</a></li>
</ul>
</li>
<li><a class="reference internal" href="#see-also" id="toc-entry-24">See Also</a></li>
</ul>
</div>
<p><span class="raw-html"></center></span></p>
<div class="section" id="overview">
<h1><a class="toc-backref" href="#toc-entry-1">Overview</a></h1>
<p>GNU/Linux is our operating system of choice, for many reasons: it is in free software, it is efficient, trustable, reliable and controllable, its mode of operation does not change much over time so any time invested on it is well spent.</p>
<p>Over the years we tried many distributions, including Ubuntu, Debian, Gentoo, Mint.</p>
<p>Our personal all-time favorite is clearly <a class="reference external" href="https://en.wikipedia.org/wiki/Arch_Linux">Arch Linux</a>, because it leaves much control to its end user (not attempting to hide details that have to be mastered anyway), it is a &quot;clean&quot; one, driven by a skilled and knowledgeable community, and also because it is a rolling distribution: it updates constantly its packages <em>without needing to regularly upgrade the whole system</em>, which would jeopardise it in the same movement (global system updates rarely complete successfully and tend to be postponed because of the many problems they trigger; we found preferable to deal with issues incrementally on a live system - rather than on one that may fail to reboot properly).</p>
<p>It ends up with a very stable, hassle-free distribution, with cutting-edge packages and higher uptimes (several months without needing to reboot), which is desirable for server-like usages.</p>
</div>
<div class="section" id="software-update">
<h1><a class="toc-backref" href="#toc-entry-2">Software Update</a></h1>
<p>The setup that we use is to perform <strong>automatic nightly updates</strong>. For that we use our <a class="reference external" href="https://github.com/Olivier-Boudeville/Ceylan-Hull/blob/master/update-distro.sh">update-distro.sh</a> script, run through root's crontab as:</p>
<pre class="code bash literal-block">
$<span class="w"> </span>crontab<span class="w"> </span>-l<span class="w">
</span><span class="c1"># Each day at 5:17 AM, update the distro:
</span><span class="m">17</span><span class="w">  </span><span class="m">05</span><span class="w">   </span>*<span class="w">   </span>*<span class="w">  </span>*<span class="w"> </span>/usr/local/bin/update-distro.sh<span class="w"> </span>-q
</pre>
<p>As a result, all packages, libraries, executables, etc. are transparently updated, for the best.</p>
<p>However, for a proper management of modules <a class="footnote-reference" href="#footnote-1" id="footnote-reference-1">[1]</a>, the kernel-related packages shall be special-cased; otherwise after the first kernel update no more modules can be loaded (they will expect to link to that latest installed kernel version, not to the older one being running).</p>
<table class="docutils footnote" frame="void" id="footnote-1" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#footnote-reference-1">[1]</a></td><td>We tried to rely on <a class="reference external" href="https://wiki.archlinux.org/title/Dynamic_Kernel_Module_Support">DKMS</a> for that, but had still issues with some graphic-related modules, so we preferred managing updates by ourselves.</td></tr>
</tbody>
</table>
<p>A first line of defense is to force the loading of the modules known to be of interest directly at boot-time, so that they can be for sure loaded and linked to the right kernel.</p>
<p>This may be done by populating <tt class="docutils literal"><span class="pre">/etc/modules-load.d/</span></tt> with as many files listing the modules to auto-load, like in:</p>
<pre class="literal-block">
::::::::::::::
/etc/modules-load.d/for-3g-keys.conf
::::::::::::::
option
usb_wwan

::::::::::::::
/etc/modules-load.d/for-all-usb-keys.conf
::::::::::::::
# To be able to mount all kinds of USB keys:
vfat
uas
dm_crypt

::::::::::::::
/etc/modules-load.d/for-mobile-file-transfer.conf
::::::::::::::
# To be able to transfer files between this hosts and mobile phones by MTP:
nls_utf8
isofs
sr_mod
cdrom
# Maybe also: agpgart ahci wdat_wdt wmi_bmof xts

::::::::::::::
/etc/modules-load.d/for-tty-serial-on-usb.conf
::::::::::::::
# To be able to connect tty-like interfaces through a USB port:
ftdi_sio
usbserial

::::::::::::::
/etc/modules-load.d/for-usb-tethering.conf
::::::::::::::
# To enable an Internet access thanks to a smartphone via USB:
usbnet
# Implies:
#rndis_host
#cdc_ether

::::::::::::::
/etc/modules-load.d/for-vlan-support.conf
::::::::::::::
# To be able to manage VLANs:
8021q
</pre>
<p>This is not sufficient though (ex: one cannot anticipate all modules needed after a while); disabling the <em>automatic</em> updates of kernels is also key to reduce issues; this can be done by specifying in <tt class="docutils literal">/etc/pacman.conf</tt>:</p>
<pre class="code bash literal-block">
<span class="nv">IgnorePkg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>linux<span class="w"> </span>linux-headers
</pre>
<p>LTS (<em>Long Term Support</em>) kernels are intentionally <em>not</em> listed here, as we prefer having them regularly updated in order to minimise the risk that the base and LTS kernels belong to too close versions (as then a problem in terms of hardware support is more likely to arise at the same time with both).</p>
<p>At least users of NVidia graphic cards may also list there their drivers, as apparently an hardware acceleration supported at boot may be lost after some time, presumably because of an update of its drivers (knowing that the update of the kernel itself was already disabled in that case) - so, if appropriate, better be safe than sorry:</p>
<pre class="code bash literal-block">
<span class="nv">IgnorePkg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>linux<span class="w"> </span>linux-headers<span class="w"> </span>nvidia<span class="w"> </span>nvidia-utils
</pre>
<p>See also our section about <a class="reference external" href="ThreeDimensional.html#os-support">operating system support for 3D</a>.</p>
<p>Updating all packages but kernel-related ones is fine, but of course the latters shall still be also updated appropriately. The best moment for that is just prior to rebooting (knowing that your Linux box never crashes, isn't it?), so for that we use (as root) our <a class="reference external" href="https://github.com/Olivier-Boudeville/Ceylan-Hull/blob/master/shutdown-local-host.sh">shutdown-local-host.sh</a> script, like in:</p>
<pre class="code bash literal-block">
$<span class="w"> </span>shutdown-local-host.sh<span class="w"> </span>--reboot
</pre>
<p>The kernel packages, and possibly driver-related ones, will then only be properly updated before the host is rebooted.</p>
</div>
<div class="section" id="package-management">
<h1><a class="toc-backref" href="#toc-entry-3">Package Management</a></h1>
<div class="section" id="configuration">
<h2><a class="toc-backref" href="#toc-entry-4">Configuration</a></h2>
<p id="enabling-multilib">One may enable the <a class="reference external" href="https://wiki.archlinux.org/title/Official_repositories#multilib">multilib</a> repository, which is useful to run 32-bit software on 64-bit hardware. This is useful for example if needing <tt class="docutils literal">wine</tt>, knowing that its build from the AUR may fail.</p>
<p>To enable multilib, uncomment in <tt class="docutils literal">/etc/pacman.conf</tt>:</p>
<pre class="code bash literal-block">
<span class="o">[</span>multilib<span class="o">]</span><span class="w">
</span><span class="nv">Include</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>/etc/pacman.d/mirrorlist
</pre>
<p>then upgrade your system with <tt class="docutils literal">pacman <span class="pre">-Syu</span></tt>.</p>
</div>
<div class="section" id="package-related-commands">
<h2><a class="toc-backref" href="#toc-entry-5">Package-related Commands</a></h2>
<ul class="simple">
<li>to get information about a package (installed or not): <tt class="docutils literal">pacman <span class="pre">-Si</span> MY_PACKAGE</tt></li>
<li>to list all packages explicitly installed and not required as dependencies: <tt class="docutils literal">pacman <span class="pre">-Qet</span></tt></li>
<li>to determine which package installed a specified file:<ul>
<li>on Arch: <tt class="docutils literal">pkgfile SOME_FILE</tt>; <tt class="docutils literal">pkgfile</tt> itself must have been installed beforehand, with <tt class="docutils literal">pacman <span class="pre">-S</span> pkgfile</tt>, and be updated, with <tt class="docutils literal">pkgfile <span class="pre">--update</span></tt> (still as root)</li>
<li>on Debian: <tt class="docutils literal"><span class="pre">apt-file</span> search SOME_FILE</tt> after a similar initial install thanks to: <tt class="docutils literal">sudo <span class="pre">apt-get</span> install <span class="pre">apt-file</span> &amp;&amp; sudo <span class="pre">apt-file</span> update</tt></li>
<li>for many distros, one may rely on the <a class="reference external" href="https://command-not-found.com/">command-not-found website</a></li>
</ul>
</li>
<li>to determine which package owns (would install) specified file(s): <tt class="docutils literal">pacman <span class="pre">-Qo</span> FILES</tt></li>
</ul>
<p>See <a class="reference external" href="https://wiki.archlinux.org/title/Pacman/Tips_and_tricks">this page</a> for many more Arch-related commands.</p>
</div>
<div class="section" id="interesting-packages">
<h2><a class="toc-backref" href="#toc-entry-6">Interesting Packages</a></h2>
<p>They might be lesser known:</p>
<ul class="simple">
<li><tt class="docutils literal">cpulimit</tt>: the way of limiting CPU usage of a given process, for example to avoid overheat (<tt class="docutils literal">nice</tt> just defines respective process priorities)</li>
<li><tt class="docutils literal"><span class="pre">inotify-tools</span></tt>: to be able to monitor filesystem events (ex: with <tt class="docutils literal">inotifywait</tt>) from scripts</li>
<li><tt class="docutils literal">jq</tt>: for command-line JSON processing (ex: <tt class="docutils literal">jq . myfile.json</tt> to display it properly on a terminal)</li>
<li><tt class="docutils literal">mathjax</tt>: to generate LaTeX-like images for the web</li>
<li><tt class="docutils literal">most</tt>: a replacement for <tt class="docutils literal">more</tt></li>
<li><tt class="docutils literal">pdftk</tt>: to transform PDF files</li>
<li><tt class="docutils literal">pkgfile</tt>: to retrieve file information about packages</li>
</ul>
</div>
</div>
<div class="section" id="systemd-related-hints">
<span id="systemd"></span><h1><a class="toc-backref" href="#toc-entry-7">Systemd-related Hints</a></h1>
<p><em>Systemd</em> is the current reference system and service manager for GNU/Linux. It is in charge of configuring, launching, monitoring, controlling, etc. all the software services running on a given host.</p>
<div class="section" id="systemd-commands">
<h2><a class="toc-backref" href="#toc-entry-8">Systemd Commands</a></h2>
<ul class="simple">
<li><strong>listing</strong> the units:<ul>
<li>managed by systemd: <tt class="docutils literal">systemctl <span class="pre">list-units</span> [PATTERN]</tt></li>
<li>installed (as files): <tt class="docutils literal">systemctl <span class="pre">list-unit-files</span> [PATTERN]</tt> or <tt class="docutils literal">tree /etc/systemd/system</tt></li>
</ul>
</li>
<li><strong>getting runtime status information</strong> about units: <tt class="docutils literal">systemctl status [PATTERN]</tt></li>
<li><strong>controlling</strong> units: <tt class="docutils literal">systemctl start|stop|restart [PATTERN]</tt></li>
<li><strong>reloading</strong>:<ul>
<li>a service-specific configuration of a unit: <tt class="docutils literal">systemctl reload [PATTERN]</tt> (ex: requesting Apache to reload its own httpd.conf file)</li>
<li>the systemd configuration file of a unit: <tt class="docutils literal">systemctl <span class="pre">daemon-reload</span> [PATTERN]</tt> (ex: reloading the <tt class="docutils literal">apache.service</tt> systemd unit file)</li>
</ul>
</li>
<li><strong>enabling/disabling</strong> for good units (while not starting/stopping them): <tt class="docutils literal">systemctl enable|disable [PATTERN]</tt></li>
</ul>
</div>
<div class="section" id="systemd-journal">
<h2><a class="toc-backref" href="#toc-entry-9">Systemd Journal</a></h2>
<p>In order to query the contents of the systemd journal (as written by <tt class="docutils literal"><span class="pre">systemd-journald.service</span></tt>), the <tt class="docutils literal">journalctl</tt> command may be used.</p>
<p>To consult the journal:</p>
<ul class="simple">
<li>from:<ul>
<li>the oldest entry collected: <tt class="docutils literal">journalctl</tt></li>
<li>last boot: <tt class="docutils literal">journalctl <span class="pre">-b</span></tt></li>
<li>the most recent journal entries, listing them to current end, and:<ul>
<li>stopping there: <tt class="docutils literal">journalctl <span class="pre">-e</span></tt></li>
<li>continuously printing the new entries as they are added: <tt class="docutils literal">journalctl <span class="pre">-f</span></tt> (or <tt class="docutils literal"><span class="pre">--follow</span></tt>)</li>
</ul>
</li>
</ul>
</li>
<li>for a given unit <tt class="docutils literal">my_unit</tt> (see <a class="reference internal" href="#systemd-commands">Systemd Commands</a> for selection): <tt class="docutils literal">journalctl <span class="pre">-u</span> my_unit</tt></li>
<li>showing <tt class="docutils literal">COUNT</tt> lines: add <tt class="docutils literal"><span class="pre">-n</span> COUNT</tt> (default: 10)</li>
</ul>
</div>
</div>
<div class="section" id="process-related-post-mortem-investigations">
<span id="core-dumps"></span><h1><a class="toc-backref" href="#toc-entry-10">Process-related Post-Mortem Investigations</a></h1>
<p>Sometimes a UNIX process crashes and, typically if one developed it, one wants to investigate the issue, based on a core dump produced by the operating system.</p>
<p>This <a class="reference external" href="https://wiki.archlinux.org/title/Core_dump">Arch Linux article</a> will give all relevant details.</p>
<p>In short, <tt class="docutils literal">coredumpctl list</tt> will list all known core dumps from oldest to most recent, such as in:</p>
<pre class="code bash literal-block">
$<span class="w"> </span>coredumpctl<span class="w"> </span>list<span class="w">
</span>TIME<span class="w">                        </span>PID<span class="w">   </span>UID<span class="w">  </span>GID<span class="w"> </span>SIG<span class="w">     </span>COREFILE<span class="w"> </span>EXE<span class="w">                </span>SIZE<span class="w">
</span><span class="o">[</span>...<span class="o">]</span><span class="w">
</span>Tue<span class="w"> </span><span class="m">2021</span>-12-21<span class="w"> </span><span class="m">20</span>:53:02<span class="w"> </span>CET<span class="w"> </span><span class="m">73873</span><span class="w"> </span><span class="m">1007</span><span class="w"> </span><span class="m">988</span><span class="w"> </span>SIGSEGV<span class="w"> </span>present<span class="w">  </span><span class="o">[</span>...<span class="o">]</span>/bin/beam.smp<span class="w"> </span><span class="m">14</span>.6M
</pre>
<p>The last core dump produced may be studied directly, thanks to <tt class="docutils literal">coredumpctl debug</tt>, relying on <tt class="docutils literal">gdb</tt> to fetch much lower-level information:</p>
<pre class="code bash literal-block">
$<span class="w"> </span>coredumpctl<span class="w"> </span>debug<span class="w">
          </span>PID:<span class="w"> </span><span class="m">73873</span><span class="w"> </span><span class="o">(</span>beam.smp<span class="o">)</span><span class="w">
          </span>UID:<span class="w"> </span><span class="m">1007</span><span class="w"> </span><span class="o">(</span>xxx<span class="o">)</span><span class="w">
          </span>GID:<span class="w"> </span><span class="m">988</span><span class="w"> </span><span class="o">(</span>users<span class="o">)</span><span class="w">
       </span>Signal:<span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="o">(</span>SEGV<span class="o">)</span><span class="w">
    </span>Timestamp:<span class="w"> </span>Tue<span class="w"> </span><span class="m">2021</span>-12-21<span class="w"> </span><span class="m">20</span>:53:01<span class="w"> </span>CET<span class="w"> </span><span class="o">(</span>38min<span class="w"> </span>ago<span class="o">)</span><span class="w">
 </span>Command<span class="w"> </span>Line:<span class="w"> </span>/home/xxx/Software/Erlang/Erlang-24.2/lib/erlang/erts-12.2/bin/beam.smp<span class="w"> </span>-W<span class="w"> </span>w<span class="w"> </span>-K<span class="w"> </span><span class="nb">true</span><span class="w"> </span>-A<span class="w"> </span><span class="m">128</span><span class="w"> </span><span class="o">[</span>...<span class="o">]</span><span class="w">
   </span>Executable:<span class="w"> </span>/home/xxx/Software/Erlang/Erlang-24.2/lib/erlang/erts-12.2/bin/beam.smp<span class="w">
</span>Control<span class="w"> </span>Group:<span class="w"> </span>/user.slice/user-1007.slice/session-2.scope<span class="w">
         </span>Unit:<span class="w"> </span>session-2.scope<span class="w">
        </span>Slice:<span class="w"> </span>user-1007.slice<span class="w">
      </span>Session:<span class="w"> </span><span class="m">2</span><span class="w">
    </span>Owner<span class="w"> </span>UID:<span class="w"> </span><span class="m">1007</span><span class="w"> </span><span class="o">(</span>xxx<span class="o">)</span><span class="w">
      </span>Boot<span class="w"> </span>ID:<span class="w"> </span>f8abe9473f7e4fea8ba24944e35ce7d9<span class="w">
   </span>Machine<span class="w"> </span>ID:<span class="w"> </span>c9413a71e7b4498f831e2df7a08e5f33<span class="w">
     </span>Hostname:<span class="w"> </span>xxx<span class="w">
      </span>Storage:<span class="w"> </span>/var/lib/systemd/coredump/core.beam<span class="se">\x</span>2esmp.1007.f8abe9473f7e4fea8ba24944e35ce7d9.73873.1640116381000000.zst<span class="w"> </span><span class="o">(</span>present<span class="o">)</span><span class="w">
    </span>Disk<span class="w"> </span>Size:<span class="w"> </span><span class="m">14</span>.6M<span class="w">
      </span>Message:<span class="w"> </span>Process<span class="w"> </span><span class="m">73873</span><span class="w"> </span><span class="o">(</span>beam.smp<span class="o">)</span><span class="w"> </span>of<span class="w"> </span>user<span class="w"> </span><span class="m">1007</span><span class="w"> </span>dumped<span class="w"> </span>core.<span class="w">

               </span>Found<span class="w"> </span>module<span class="w"> </span>/home/xxx/Software/Erlang/Erlang-24.2/lib/erlang/erts-12.2/bin/beam.smp<span class="w"> </span>with<span class="w"> </span>build-id:<span class="w"> </span>8cfbf76728dd7399444638f1ba124471181840e7<span class="w">
               </span>Found<span class="w"> </span>module<span class="w"> </span>/home/xxx/Software/Erlang/Erlang-24.2/lib/erlang/lib/wx-2.1.1/priv/erl_gl.so<span class="w"> </span>with<span class="w"> </span>build-id:<span class="w"> </span>0b96532e586839d3da9afd6e5f23aa76346a0e45<span class="w">
</span><span class="o">[</span>...<span class="o">]</span><span class="w">
   </span>Stack<span class="w"> </span>trace<span class="w"> </span>of<span class="w"> </span>thread<span class="w"> </span><span class="m">74039</span>:<span class="w">
   </span><span class="c1">#0  0x00007f6e5461a74b __memmove_avx_unaligned_erms (libc.so.6 + 0x16374b)
</span><span class="w">   </span><span class="c1">#1  0x00007f6d8a204428 n/a (iris_dri.so + 0xd12428)
</span><span class="w">   </span><span class="c1">#2  0x00007f6d89733207 n/a (iris_dri.so + 0x241207)
</span><span class="w">   </span><span class="c1">#3  0x00007f6d89733c97 n/a (iris_dri.so + 0x241c97)
</span><span class="w">   </span><span class="c1">#4  0x00007f6d898d8b0d n/a (iris_dri.so + 0x3e6b0d)
</span><span class="w">   </span><span class="c1">#5  0x00007f6d898d8bf2 n/a (iris_dri.so + 0x3e6bf2)
</span><span class="w">   </span><span class="c1">#6  0x00007f6d8b2f241c n/a (/home/xxx/Software/Erlang/Erlang-24.2/lib/erlang/lib/wx-2.1.1/priv/erl_gl.so + 0x5b41c)
</span><span class="o">[</span>New<span class="w"> </span>LWP<span class="w"> </span><span class="m">74039</span><span class="o">]</span><span class="w">
</span><span class="o">[</span>New<span class="w"> </span>LWP<span class="w"> </span><span class="m">73873</span><span class="o">]</span><span class="w">
</span><span class="o">[</span>...<span class="o">]</span><span class="w">
</span>Core<span class="w"> </span>was<span class="w"> </span>generated<span class="w"> </span>by<span class="w"> </span><span class="sb">`</span>/home/xxx/Software/Erlang/Erlang-24.2/lib/erlang/erts-12.2/bin/beam.smp<span class="w"> </span>-<span class="err">'</span>.<span class="w">
</span>Program<span class="w"> </span>terminated<span class="w"> </span>with<span class="w"> </span>signal<span class="w"> </span>SIGSEGV,<span class="w"> </span>Segmentation<span class="w"> </span>fault.<span class="w">
</span><span class="c1">#0  0x00007f6e5461a74b in __memmove_avx_unaligned_erms () from /usr/lib/libc.so.6
</span><span class="o">[</span>Current<span class="w"> </span>thread<span class="w"> </span>is<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">(</span>Thread<span class="w"> </span>0x7f6d900aa640<span class="w"> </span><span class="o">(</span>LWP<span class="w"> </span><span class="m">74039</span><span class="o">))]</span>
</pre>
<p>Then:</p>
<pre class="code literal-block">
(gdb) bt
[...]
#0  0x00007f6e5461a74b in __memmove_avx_unaligned_erms () at /usr/lib/libc.so.6
#1  0x00007f6d8a204428 in  () at /usr/lib/dri/iris_dri.so
#2  0x00007f6d89733207 in  () at /usr/lib/dri/iris_dri.so
#3  0x00007f6d89733c97 in  () at /usr/lib/dri/iris_dri.so
#4  0x00007f6d898d8b0d in  () at /usr/lib/dri/iris_dri.so
#5  0x00007f6d898d8bf2 in  () at /usr/lib/dri/iris_dri.so
#6  0x00007f6d8b2f241c in ecb_glTexImage2D(ErlNifEnv*, ErlNifPid*, ERL_NIF_TERM*) (env=0x5642f62bdea0, self=0x5642f665e148, argv=0x5642f665e168) at gen/gl_nif.cpp:2844
[...]
#29 0x00007f6d92967188 in wxe_main_loop(void*) (_unused=&lt;optimized out&gt;) at wxe_main.cpp:138
</pre>
<p>(this example was an Erlang wx/OpenGL-oriented crash)</p>
<p>From there, <a class="reference external" href="https://sourceware.org/gdb/current/onlinedocs/gdb/">standard gdb-fu</a> shall be sufficient to give much insight. Once done, use <tt class="docutils literal">q</tt> to quit.</p>
</div>
<div class="section" id="filesystem-related-issues">
<h1><a class="toc-backref" href="#toc-entry-11">Filesystem-related Issues</a></h1>
<p>Word of wisdom: perform backups. Regularly. Safely stored.</p>
<div class="section" id="target-is-busy">
<h2><a class="toc-backref" href="#toc-entry-12">Target is busy</a></h2>
<p>Umounting may fail with <tt class="docutils literal">umount: /var/foobar: target is busy</tt>. Finding the culprit can be done with:</p>
<pre class="code bash literal-block">
$<span class="w"> </span>lsof<span class="w"> </span>/var/foobar
</pre>
<p>COMMAND    PID USER   FD   TYPE DEVICE SIZE/OFF     NODE NAME
bash    275648 root  cwd    DIR  254,1    20480 45236687 /var/foobar/www/Foo</p>
</div>
<div class="section" id="failed-i-o-operations">
<h2><a class="toc-backref" href="#toc-entry-13">Failed I/O Operations</a></h2>
<p>Some operations (even a <tt class="docutils literal">touch</tt> done by <tt class="docutils literal">root</tt>) may fail, reporting <tt class="docutils literal"><span class="pre">Read-only</span> file system</tt>; <tt class="docutils literal"><span class="pre">systemd-fsck</span></tt> may also report <tt class="docutils literal">Structure needs cleaning</tt>.</p>
<p>Check with <tt class="docutils literal">mount</tt> that a given filesystem/partition is (still) in the expected state:</p>
<pre class="code bash literal-block">
<span class="c1"># For example:
</span>/dev/mapper/foobar<span class="w"> </span>on<span class="w"> </span>/var/foobar<span class="w"> </span><span class="nb">type</span><span class="w"> </span>ext4<span class="w"> </span><span class="o">(</span>rw,relatime,data<span class="o">=</span>ordered<span class="o">)</span><span class="w">

</span><span class="c1"># may have become:
</span>/dev/mapper/foobar<span class="w"> </span>on<span class="w"> </span>/var/foobar<span class="w"> </span><span class="nb">type</span><span class="w"> </span>ext4<span class="w"> </span><span class="o">(</span>ro,relatime,errors<span class="o">=</span><span class="k">continue</span>,data<span class="o">=</span>ordered<span class="o">)</span>
</pre>
<p>Best option here is to unmount, make a sector-level backup of the disk, and then check it. Probably that the disk already failed and you will have to resort to revert to a former backup.</p>
</div>
<div class="section" id="checking-a-disk">
<h2><a class="toc-backref" href="#toc-entry-14">Checking a Disk</a></h2>
<p>This can be done with <tt class="docutils literal">e2fsck</tt> once the filesystem is unmounted, like in: <tt class="docutils literal">e2fsck <span class="pre">-cDp</span> /dev/mapper/foobar</tt>, with:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">-c</span></tt>: use <tt class="docutils literal">badblocks</tt> to do a read-only scan of the device</li>
<li><tt class="docutils literal"><span class="pre">-D</span></tt>: optimize directories in the filesystem</li>
<li><tt class="docutils literal"><span class="pre">-p</span></tt>: automatically repair (&quot;preen&quot;) the file system</li>
</ul>
<p>If having errors like:</p>
<pre class="literal-block">
e2fsck: Input/output error while trying to open /dev/mapper/foobar``
</pre>
<p>or:</p>
<pre class="literal-block">
The superblock could not be read or does not describe a valid
ext2/ext3/ext4 filesystem [...]
</pre>
<p>then, unless you are trying to check an encrypted partition (ex: not having cryptsetup-opened a LUKS one) or a superblock copy is enough, prospects are grim.</p>
<p>Try for example <tt class="docutils literal">fdisk</tt> / <tt class="docutils literal">gdisk</tt> / <tt class="docutils literal">cgdisk</tt>, <tt class="docutils literal">parted</tt>, <tt class="docutils literal">smartctl <span class="pre">--all</span> <span class="pre">-T</span> verypermissive</tt>, <tt class="docutils literal">badblocks <span class="pre">-o</span> <span class="pre">~/scan-result.txt</span> <span class="pre">-sv</span></tt> (for which errors are counted as NumberOfReadErrors / NumberOfWriteErrors / NumberOfCorruptionErrors) - yet your disk is maybe already unrecoverable.</p>
</div>
</div>
<div class="section" id="quick-topics">
<h1><a class="toc-backref" href="#toc-entry-15">Quick Topics</a></h1>
<div class="section" id="installing-wine">
<h2><a class="toc-backref" href="#toc-entry-16">Installing Wine</a></h2>
<p>Install it, once <a class="reference internal" href="#enabling-multilib">enabling multilib</a> has been done, with: <tt class="docutils literal">pacman <span class="pre">-S</span> wine</tt>.</p>
<p>When run, this may lead <tt class="docutils literal"><span class="pre">wine-mono</span></tt> to be auto-installed.</p>
<p>The pseudo-Windows filesystem is then located mostly in <tt class="docutils literal"><span class="pre">~/.wine/drive_c</span></tt>.</p>
</div>
<div class="section" id="invalid-pgp-signatures-in-packages">
<h2><a class="toc-backref" href="#toc-entry-17">Invalid PGP Signatures in Packages</a></h2>
<p>This happens regularly, symptom being: <tt class="docutils literal">File /var/cache/pacman/pkg/xxx.pkg.tar.zst is corrupted (invalid or corrupted package (PGP signature))</tt>.</p>
<p>Solution: <tt class="docutils literal">pacman <span class="pre">-S</span> <span class="pre">archlinux-keyring</span></tt> is at least often enough. Otherwise <tt class="docutils literal"><span class="pre">pacman-key</span> <span class="pre">--populate</span> archlinux</tt>, or changing mirror might help.</p>
</div>
<div class="section" id="adding-a-locale">
<h2><a class="toc-backref" href="#toc-entry-18">Adding a Locale</a></h2>
<p>On some hosts, issues in terms of a lacking locales may be reported, like in the following:</p>
<pre class="literal-block">
bash: warning: setlocale: LC_ALL: cannot change locale (en_US.UTF-8)
</pre>
<p>This can be fixed by uncommenting the corresponding locale (<tt class="docutils literal"><span class="pre">en_US.UTF-8</span></tt> here) in <tt class="docutils literal">/etc/locale.gen</tt>, and then regenerating the system locales by running (as root) <tt class="docutils literal"><span class="pre">locale-gen</span></tt>:</p>
<pre class="code bash literal-block">
$<span class="w"> </span>locale-gen<span class="w">
</span>Generating<span class="w"> </span>locales<span class="w"> </span><span class="o">(</span>this<span class="w"> </span>might<span class="w"> </span>take<span class="w"> </span>a<span class="w"> </span><span class="k">while</span><span class="o">)</span>...<span class="w">
 </span>en_US.UTF-8...<span class="w"> </span><span class="k">done</span><span class="w">
 </span>fr_FR.UTF-8...<span class="w"> </span><span class="k">done</span><span class="w">
 </span>fr_FR.ISO-8859-15&#64;euro...<span class="w"> </span><span class="k">done</span><span class="w">
</span>Generation<span class="w"> </span>complete.
</pre>
</div>
<div class="section" id="applying-a-xfce4-configuration-to-a-different-user">
<h2><a class="toc-backref" href="#toc-entry-19">Applying a XFCE4 configuration to a different user</a></h2>
<p>The objective is to duplicate the configuration of the <tt class="docutils literal">user_a</tt> desktop to the <tt class="docutils literal">user_b</tt> one, for example if <tt class="docutils literal">user_b</tt> is used to test an untrusted application.</p>
<p>A key point is to ensure that at least <tt class="docutils literal">user_b</tt> has no ongoing graphical session (otherwise any new configuration may be overwritten with an older one at logout).</p>
<p>Then, typically as root:</p>
<pre class="code bash literal-block">
$<span class="w"> </span>rm<span class="w"> </span>-rf<span class="w"> </span>/home/user_b/.config/<span class="o">{</span>xfce4,Thunar<span class="o">}</span><span class="w"> </span>/home/user_b/.local/share/xfce4<span class="w">
</span>$<span class="w"> </span>cp<span class="w"> </span>-rf<span class="w"> </span>/home/user_a/.config/<span class="o">{</span>xfce4,Thunar<span class="o">}</span><span class="w"> </span>/home/user_b/.config<span class="w">
</span>$<span class="w"> </span>cp<span class="w"> </span>-rf<span class="w"> </span>/home/user_a/.local/share/xfce4<span class="w"> </span>/home/user_b/.local/share<span class="w">
</span>$<span class="w"> </span>chmod<span class="w"> </span>-R<span class="w"> </span>/home/user_b/<span class="o">{</span>.config,.local<span class="o">}</span><span class="w"> </span>user_b:users
</pre>
<p>Then a key point is to fully reset XFCE4. Unlogging and/or <tt class="docutils literal">killall <span class="pre">-HUP</span> xfdesktop</tt> may not be sufficient. As a last resort, rebooting shall work.</p>
<p>Selecting a per-user wallpaper may be of help.</p>
</div>
<div class="section" id="emacs">
<h2><a class="toc-backref" href="#toc-entry-20">Emacs</a></h2>
<div class="section" id="configuration-1">
<span id="emacs-configuration"></span><h3>Configuration</h3>
<p>Our <a class="reference external" href="https://github.com/Olivier-Boudeville/Ceylan-Myriad/blob/master/conf/init.el">init.el</a>, that may be stored in <tt class="docutils literal"><span class="pre">~/.emacs.d/</span></tt>, currently relies on <a class="reference external" href="https://github.com/radian-software/straight.el">straight.el</a>.</p>
</div>
<div class="section" id="hints">
<h3>Hints</h3>
<ul class="simple">
<li>to tune the font size:<ul>
<li>temporarily: use <tt class="docutils literal"><span class="pre">C-x</span> <span class="pre">C-+</span></tt> to increase, <tt class="docutils literal"><span class="pre">C-x</span> <span class="pre">C--</span></tt> to decrease (or press Shift then click the first mouse button to select a relevant option)</li>
<li>permanently: one may add in one's <a class="reference internal" href="#emacs-configuration">Emacs configuration</a> file for example: <tt class="docutils literal"><span class="pre">(set-face-attribute</span> 'default nil :height 100)</tt></li>
</ul>
</li>
<li>to insert in the current buffer the output of a shell command: <tt class="docutils literal"><span class="pre">Ctrl-U</span> then <span class="pre">Alt-!</span></tt>: enter that shell command, whose output will be pasted at the current cursor position</li>
<li>to prefix all lines of the selected region: <tt class="docutils literal"><span class="pre">Ctr-X</span> then r then t</tt>, then type the prefix then type Enter</li>
<li>to sort alphabetically the selected region: <tt class="docutils literal"><span class="pre">Meta-x</span> <span class="pre">sort-lines</span></tt></li>
<li>to go to the matching delimiter (parenthesis, bracket, end of word, etc.): to go forward, use <tt class="docutils literal"><span class="pre">C-M-f</span></tt>, and to go backward use <tt class="docutils literal"><span class="pre">C-M-b</span></tt></li>
</ul>
<p>Other useful commands to trigger with <tt class="docutils literal"><span class="pre">Meta-x</span></tt>:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">replace-string</span></tt></li>
<li><tt class="docutils literal"><span class="pre">query-replace</span></tt></li>
<li><tt class="docutils literal"><span class="pre">kill-rectangle</span></tt></li>
<li><tt class="docutils literal"><span class="pre">Ctrl-g</span></tt> to abort the current entry in the minibuffer</li>
</ul>
</div>
<div class="section" id="troubleshooting">
<h3>Troubleshooting</h3>
<p>Sometimes problems arise due to older packages, this may be solved by removing the <tt class="docutils literal"><span class="pre">~/.emacs.d/straight</span></tt> directory, relaunching Emacs and waiting for all related clones to be downloaded again.</p>
</div>
</div>
<div class="section" id="e-mail-clients">
<h2><a class="toc-backref" href="#toc-entry-21">E-mail Clients</a></h2>
<p>Over time we were preferring <a class="reference external" href="https://help.gnome.org/users/evolution/stable/index.html">Evolution</a> to <a class="reference external" href="https://www.thunderbird.net/">Thunderbird</a>, notably regarding its far better <a class="reference external" href="Cybersecurity.html#securing-thanks-to-openpgp">OpenPGP</a> support. Yet, at least for some IMAP servers (e.g. the ones of <a class="reference external" href="https://www.mailo.com/">Mailo</a>), errors (like: <tt class="docutils literal">Error copying messages: Error</tt>) constantly happening (despite many attempts of configuration changes) and being reported ruined its use for us <a class="footnote-reference" href="#footnote-2" id="footnote-reference-2">[2]</a>, so we switched back to Thunderbird.</p>
<table class="docutils footnote" frame="void" id="footnote-2" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#footnote-reference-2">[2]</a></td><td>Moreover the fixed character-wrapping of Evolution is rather surprising and unfortunate.</td></tr>
</tbody>
</table>
<ul class="simple">
<li>for Thunderbird: we recommend using the <a class="reference external" href="https://addons.thunderbird.net/en-us/thunderbird/addon/dkim-verifier/">DKIM Verifier</a> add-on, that we found much useful to better detect spoofing attempts</li>
<li>for Evolution: on Arch Linux, consider installing the <tt class="docutils literal"><span class="pre">evolution-bogofilter</span></tt> and/or <tt class="docutils literal"><span class="pre">evolution-spamassassin</span></tt> packages, otherwise spams (junk mails) do not seem to be managed properly (or at all)</li>
</ul>
<p>See also Ceylan-Hull's <a class="reference external" href="https://github.com/Olivier-Boudeville/Ceylan-Hull/blob/master/email.sh/">email.sh</a> and <a class="reference external" href="https://github.com/Olivier-Boudeville/Ceylan-Hull/blob/master/archive-emails.sh">archive-emails.sh</a> scripts.</p>
</div>
<div class="section" id="other-settings">
<h2><a class="toc-backref" href="#toc-entry-22">Other Settings</a></h2>
<p>See our <a class="reference external" href="https://www.startpage.com/do/mypage.pl?prfe=cd347822749aab26ebcc5b5e5d0352b578a0f37dc831f791974bb7f9549e7d5c2614650b7157b6f29bccdcb6675b437eeee32a5a5f37686b01ea56658d241d1925959ace1973900c97547972ffa464fd80e1cb6a">preferences</a> for <a class="reference external" href="https://www.startpage.com">Startpage</a>; it can be set as homepage.</p>
</div>
<div class="section" id="shortcuts">
<h2><a class="toc-backref" href="#toc-entry-23">Shortcuts</a></h2>
<p>Listing here the main keyboard shortcuts of interest for a few base tools.</p>
<div class="section" id="for-less">
<h3>For <tt class="docutils literal">less</tt></h3>
<p>Mix of <tt class="docutils literal">vi</tt> / <tt class="docutils literal">more</tt> conventions, in order to:</p>
<ul class="simple">
<li><strong>forward-search</strong> for the N-th line containing the pattern (N defaults to 1): <tt class="docutils literal">/pattern</tt>; use <tt class="docutils literal"><span class="pre">?/pattern</span></tt> to <strong>backward-search</strong></li>
<li><strong>repeat previous search</strong>: <tt class="docutils literal">n</tt>:</li>
<li><strong>invoke an editor</strong> on the current file being viewed: <tt class="docutils literal">v</tt></li>
<li><strong>go to next file</strong>: <tt class="docutils literal">:n</tt>; for the <strong>previous</strong> one: <tt class="docutils literal">:p</tt></li>
<li><strong>help</strong>: <tt class="docutils literal">h</tt></li>
<li><strong>quit</strong>: <tt class="docutils literal">q</tt></li>
</ul>
</div>
<div class="section" id="for-mplayer">
<h3>For <tt class="docutils literal">mplayer</tt></h3>
<ul class="simple">
<li><strong>pause/unpause</strong> the current playback: <tt class="docutils literal">&lt;space&gt;</tt></li>
<li><strong>decrease the volume</strong>: <tt class="docutils literal">/</tt>; to <strong>increase</strong> it: <tt class="docutils literal">*</tt></li>
<li><strong>go backward/forward</strong> in the current playback: <tt class="docutils literal">left</tt> and <tt class="docutils literal">right arrow</tt> keys</li>
<li><strong>jump to next playback</strong>: <tt class="docutils literal">&lt;Enter&gt;</tt> or <tt class="docutils literal">&lt;Escape&gt;</tt></li>
<li><strong>stop</strong> all playbacks: <tt class="docutils literal"><span class="pre">&lt;CTRL-C&gt;</span></tt></li>
<li><strong>display durations</strong>: <tt class="docutils literal">o</tt> to toggle OSD (<em>On-Screen Display</em>), i.e. elapsed, elapsed / total, etc.</li>
<li><strong>take a screenshot</strong>: <tt class="docutils literal">s</tt> (notably if using our <a class="reference external" href="https://github.com/Olivier-Boudeville/Ceylan-Hull/blob/master/v">v</a> script, as the <tt class="docutils literal"><span class="pre">-vf</span> screenshot</tt> command-line option must have been specified); then a <tt class="docutils literal">shot0001.png</tt> file will be silently created in the directory whence mplayer was launched, next screenshot will be <tt class="docutils literal">shot0002.png</tt>, etc.</li>
</ul>
</div>
</div>
</div>
<div class="section" id="see-also">
<h1><a class="toc-backref" href="#toc-entry-24">See Also</a></h1>
<p>One may refer to our other mini-HOWTO regarding:</p>
<ul class="simple">
<li><a class="reference external" href="Networking.html">Network Management</a></li>
<li><a class="reference external" href="Cybersecurity.html">Cybersecurity</a></li>
</ul>
<p>The Ceylan-Hull section <a class="reference external" href="https://hull.esperide.org/#system-related">system-related section</a> might also be of interest.</p>
<p><span class="raw-html"><a name="howtos_bottom"></a></span></p>
</div>
</div>
</body>
</html>
